1. What is the total amount spent in each category?

SELECT category, SUM("amount paid") AS total_spent FROM expenses GROUP BY category ORDER BY total_spent DESC;

2. What is the total amount spent using each payment mode?

SELECT "Payment Mode", SUM("amount paid") AS total_spent FROM expenses GROUP BY "Payment Mode" ORDER BY total_spent DESC;

3. What is the total cashback received across all transactions?

SELECT SUM(cashback) AS total_cashback FROM expenses;

4. Which are the top 5 most expensive categories in terms of spending?

SELECT category, SUM("amount paid") AS total_spent FROM expenses GROUP BY category ORDER BY total_spent DESC LIMIT 5;

5. How much was spent on transportation using different payment modes?

SELECT "Payment Mode", SUM("amount paid") AS total_spent FROM expenses WHERE category = 'Transportation' GROUP BY "Payment Mode" ORDER BY total_spent DESC;
6. Which transactions resulted in cashback?

SELECT * FROM expenses WHERE cashback > 0;
7. What is the total spending in each month of the year?

SELECT strftime('%Y-%m', date) AS month, SUM("amount paid") AS total_spent FROM expenses GROUP BY month ORDER BY month;
8. Which months have the highest spending in categories like "Travel," "Entertainment," or "Gifts"?

SELECT strftime('%Y-%m', date) AS month, category, SUM("amount paid") AS total_spent FROM expenses WHERE category IN ('Transportation', 'Entertainment', 'Gifts') GROUP BY month, category ORDER BY total_spent DESC;

9. Are there any recurring expenses that occur during specific months of the year (e.g., insurance premiums, property taxes)?

SELECT Category, Description, COUNT(*) AS Occurrences, STRFTIME('%m', Date) AS Month FROM expenses GROUP BY Category, Description, STRFTIME('%m', Date) HAVING COUNT(*) > 1 ORDER BY Month ASC, Category ASC, Occurrences DESC;


10. How much cashback or rewards were earned in each month?

SELECT strftime('%Y-%m', date) AS month, SUM(cashback) AS total_cashback FROM expenses WHERE cashback > 0 GROUP BY month ORDER BY month;

11. How has your overall spending changed over time (e.g., increasing, decreasing, remaining stable)?

SELECT strftime('%Y-%m', date) AS month, SUM("amount paid") AS total_spent FROM expenses GROUP BY month ORDER BY month;

12. What are the typical costs associated with different types of travel (e.g., flights, accommodation, transportation)?

SELECT Description, SUM("Amount Paid") AS Total_Amount_Paid FROM expenses WHERE Category = 'Transportation' GROUP BY Description;

This query helps find out the average amount spent per transaction in travel-related categories.
13. Are there any patterns in grocery spending (e.g., higher spending on weekends, increased spending during specific seasons)?

SELECT CASE WHEN strftime('%w', "Date") IN ('0', '6') THEN 'Weekend'   -- 0 = Sunday, 6 = Saturday ELSE 'Weekday' END AS Day_Type, SUM("Amount Paid") AS Total_Spending FROM expenses WHERE "Description" LIKE '%groceries%' GROUP BY Day_Type;

15. Which category contributes the highest percentage of the total spending?

SELECT 
    "Category",
    SUM("Amount Paid") AS Total_Spending,
    (SUM("Amount Paid") / (SELECT SUM("Amount Paid") FROM expenses)) * 100 AS Percentage_Contribution
FROM expenses
GROUP BY "Category"
ORDER BY Percentage_Contribution DESC;

16. On Which date of every month bills where paid?

SELECT strftime('%m', Date) AS Month, MIN(Date) AS First_Payment_Date
FROM expenses
WHERE Category = 'Bills'
GROUP BY strftime('%Y-%m', Date)
ORDER BY strftime('%Y-%m', Date);

17. Money spent in purchasing books for every month?


SELECT 
    strftime('%Y-%m', Date) AS month,
    SUM(CASE WHEN Description LIKE '%books%' THEN "Amount Paid" ELSE 0 END) AS total_amount_spent_on_books
FROM expenses
GROUP BY month
ORDER BY month;

18. Quarterly spending of fuel ?

SELECT 
    strftime('%Y', Date) AS Year,
    CASE 
        WHEN strftime('%m', Date) BETWEEN '01' AND '03' THEN 'Q4_2024'
        WHEN strftime('%m', Date) BETWEEN '04' AND '06' THEN 'Q1_2025'
        WHEN strftime('%m', Date) BETWEEN '07' AND '09' THEN 'Q2_2025'
        WHEN strftime('%m', Date) BETWEEN '10' AND '12' THEN 'Q3_2025'
        ELSE 'Other Quarter'
    END AS Quarter,
    SUM("Amount Paid") AS Total_Spending
FROM expenses
GROUP BY Year, Quarter
ORDER BY Year, Quarter

19. On which day maximum number of movies were seen?

SELECT 
  CASE strftime('%w', Date)
    WHEN '0' THEN 'Sunday'
    WHEN '1' THEN 'Monday'
    WHEN '2' THEN 'Tuesday'
    WHEN '3' THEN 'Wednesday'
    WHEN '4' THEN 'Thursday'
    WHEN '5' THEN 'Friday'
    WHEN '6' THEN 'Saturday'
  END AS DayOfWeek,
  COUNT(*) AS MovieCount
FROM expenses
WHERE Description LIKE '%movie%'
GROUP BY DayOfWeek
ORDER BY MovieCount DESC
LIMIT 1;

